CREATE OR REPLACE FUNCTION coretransactiondetail_insert_update_delete() RETURNS TRIGGER AS $CoreTransactionDetail_Audit$
		BEGIN
				IF (TG_OP = 'DELETE') THEN
						INSERT INTO dbo."CoreTransactionDetail_Audit"(
			"CoreTransactionDetailId", 
			"FromEntityTypeRefEnumValueId", 
			"FromEntityId", 
			"ToEntityTypeRefEnumValueId", 
			"ToEntityId", 
			"Amount", 
			"Comission", 
			"Charges", 
			"Notes", 
			"IsDelivery", 
			"DeliveryRefEmployeeId", 
			"AcceptedByCustomer", 
			"CustomerNotes", 
			"AcceptedByEmployee", 
			"EmployeeNotes", 
			"500RupeesNotes", 
			"200RupeesNotes", 
			"100RupeesNotes", 
			"50RupeesNotes", 
			"20RupeesNotes", 
			"10RupeesNotes", 
			"AddedByRefEmployeeId", 
			"AddedOn", 
			"LastEditedByRefEmployeeId", 
			"LastEditedOn", 
			"FromEntityUpdatedBalance", 
			"ToEntityUpdatedBalance", 
			"DepositDate",
			"CoreDeliveryTransactionDetailId",
			"AuditDMLActionId", 
			"AuditDateTime")
			SELECT
			OLD."CoreTransactionDetailId", 
			OLD."FromEntityTypeRefEnumValueId", 
			OLD."FromEntityId", 
			OLD."ToEntityTypeRefEnumValueId", 
			OLD."ToEntityId", 
			OLD."Amount", 
			OLD."Comission", 
			OLD."Charges", 
			OLD."Notes", 
			OLD."IsDelivery", 
			OLD."DeliveryRefEmployeeId", 
			OLD."AcceptedByCustomer", 
			OLD."CustomerNotes", 
			OLD."AcceptedByEmployee", 
			OLD."EmployeeNotes", 
			OLD."500RupeesNotes", 
			OLD."200RupeesNotes", 
			OLD."100RupeesNotes", 
			OLD."50RupeesNotes", 
			OLD."20RupeesNotes", 
			OLD."10RupeesNotes", 
			OLD."AddedByRefEmployeeId", 
			OLD."AddedOn", 
			OLD."LastEditedByRefEmployeeId", 
			OLD."LastEditedOn", 
			OLD."FromEntityUpdatedBalance", 
			OLD."ToEntityUpdatedBalance", 
			OLD."DepositDate",
			OLD."CoreDeliveryTransactionDetailId",
			-1, 
			now();
				ELSIF (TG_OP = 'UPDATE') THEN
						INSERT INTO dbo."CoreTransactionDetail_Audit"(
			"CoreTransactionDetailId", 
			"FromEntityTypeRefEnumValueId", 
			"FromEntityId", 
			"ToEntityTypeRefEnumValueId", 
			"ToEntityId", 
			"Amount", 
			"Comission", 
			"Charges", 
			"Notes", 
			"IsDelivery", 
			"DeliveryRefEmployeeId", 
			"AcceptedByCustomer", 
			"CustomerNotes", 
			"AcceptedByEmployee", 
			"EmployeeNotes", 
			"500RupeesNotes", 
			"200RupeesNotes", 
			"100RupeesNotes", 
			"50RupeesNotes", 
			"20RupeesNotes", 
			"10RupeesNotes", 
			"AddedByRefEmployeeId", 
			"AddedOn", 
			"LastEditedByRefEmployeeId", 
			"LastEditedOn", 
			"FromEntityUpdatedBalance", 
			"ToEntityUpdatedBalance", 
			"DepositDate",
			"CoreDeliveryTransactionDetailId",
			"AuditDMLActionId", 
			"AuditDateTime")
			SELECT
			NEW."CoreTransactionDetailId", 
			NEW."FromEntityTypeRefEnumValueId", 
			NEW."FromEntityId", 
			NEW."ToEntityTypeRefEnumValueId", 
			NEW."ToEntityId", 
			NEW."Amount", 
			NEW."Comission", 
			NEW."Charges", 
			NEW."Notes", 
			NEW."IsDelivery", 
			NEW."DeliveryRefEmployeeId", 
			NEW."AcceptedByCustomer", 
			NEW."CustomerNotes", 
			NEW."AcceptedByEmployee", 
			NEW."EmployeeNotes", 
			NEW."500RupeesNotes", 
			NEW."200RupeesNotes", 
			NEW."100RupeesNotes", 
			NEW."50RupeesNotes", 
			NEW."20RupeesNotes", 
			NEW."10RupeesNotes", 
			NEW."AddedByRefEmployeeId", 
			NEW."AddedOn", 
			NEW."LastEditedByRefEmployeeId", 
			NEW."LastEditedOn", 
			NEW."FromEntityUpdatedBalance", 
			NEW."ToEntityUpdatedBalance", 
			NEW."DepositDate",
			NEW."CoreDeliveryTransactionDetailId",
			0, 
			now();
				ELSIF (TG_OP = 'INSERT') THEN
						INSERT INTO dbo."CoreTransactionDetail_Audit"(
			"CoreTransactionDetailId", 
			"FromEntityTypeRefEnumValueId", 
			"FromEntityId", 
			"ToEntityTypeRefEnumValueId", 
			"ToEntityId", 
			"Amount", 
			"Comission", 
			"Charges", 
			"Notes", 
			"IsDelivery", 
			"DeliveryRefEmployeeId", 
			"AcceptedByCustomer", 
			"CustomerNotes", 
			"AcceptedByEmployee", 
			"EmployeeNotes", 
			"500RupeesNotes", 
			"200RupeesNotes", 
			"100RupeesNotes", 
			"50RupeesNotes", 
			"20RupeesNotes", 
			"10RupeesNotes", 
			"AddedByRefEmployeeId", 
			"AddedOn", 
			"LastEditedByRefEmployeeId", 
			"LastEditedOn", 
			"FromEntityUpdatedBalance", 
			"ToEntityUpdatedBalance", 
			"DepositDate",
			"CoreDeliveryTransactionDetailId",
			"AuditDMLActionId", 
			"AuditDateTime")
			SELECT
			NEW."CoreTransactionDetailId", 
			NEW."FromEntityTypeRefEnumValueId", 
			NEW."FromEntityId", 
			NEW."ToEntityTypeRefEnumValueId", 
			NEW."ToEntityId", 
			NEW."Amount", 
			NEW."Comission", 
			NEW."Charges", 
			NEW."Notes", 
			NEW."IsDelivery", 
			NEW."DeliveryRefEmployeeId", 
			NEW."AcceptedByCustomer", 
			NEW."CustomerNotes", 
			NEW."AcceptedByEmployee", 
			NEW."EmployeeNotes", 
			NEW."500RupeesNotes", 
			NEW."200RupeesNotes", 
			NEW."100RupeesNotes", 
			NEW."50RupeesNotes", 
			NEW."20RupeesNotes", 
			NEW."10RupeesNotes", 
			NEW."AddedByRefEmployeeId", 
			NEW."AddedOn", 
			NEW."LastEditedByRefEmployeeId", 
			NEW."LastEditedOn", 
			NEW."FromEntityUpdatedBalance", 
			NEW."ToEntityUpdatedBalance", 
			NEW."DepositDate",
			NEW."CoreDeliveryTransactionDetailId",
			1, 
			now();
				END IF;
				RETURN NULL; -- result is ignored since this is an AFTER trigger
		END;
$CoreTransactionDetail_Audit$ LANGUAGE plpgsql;

CREATE TRIGGER CoreTransactionDetail_Audit
AFTER INSERT OR UPDATE OR DELETE ON dbo."CoreTransactionDetail"
		FOR EACH ROW EXECUTE FUNCTION coretransactiondetail_insert_update_delete();
